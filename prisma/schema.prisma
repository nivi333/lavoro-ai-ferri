generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model companies {
  id                String              @id
  company_id        String              @unique
  name              String
  slug              String              @unique
  industry          String?
  description       String?
  logo_url          String?
  website           String?
  tax_id            String?
  email             String?
  phone             String?
  address_line_1    String?
  address_line_2    String?
  city              String?
  state             String?
  country           String?
  pincode           String?
  contact_info      Json?
  established_date  DateTime?
  business_type     String?
  certifications    String[]
  is_active         Boolean             @default(true)
  created_at        DateTime            @default(now())
  updated_at        DateTime
  default_location  String?
  company_locations company_locations[]
  user_companies    user_companies[]
}

model company_locations {
  id              String       @id
  location_id     String       @unique
  company_id      String
  name            String
  is_default      Boolean      @default(false)
  is_headquarters Boolean      @default(false)
  location_type   LocationType @default(BRANCH)
  is_active       Boolean      @default(true)
  created_at      DateTime     @default(now())
  updated_at      DateTime
  address_line_1  String?
  address_line_2  String?
  city            String?
  country         String?
  email           String?
  phone           String?
  pincode         String?
  state           String?
  companies       companies    @relation(fields: [company_id], references: [id], onDelete: Cascade)
}

model sessions {
  id         String   @id
  user_id    String
  company_id String?
  token      String   @unique
  is_active  Boolean  @default(true)
  expires_at DateTime
  created_at DateTime @default(now())
  updated_at DateTime
  users      users    @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model user_companies {
  id         String    @id
  user_id    String
  company_id String
  role       Role      @default(EMPLOYEE)
  is_active  Boolean   @default(true)
  created_at DateTime  @default(now())
  updated_at DateTime
  companies  companies @relation(fields: [company_id], references: [id], onDelete: Cascade)
  users      users     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([user_id, company_id])
}

model users {
  id             String           @id
  first_name     String
  last_name      String
  email          String?          @unique
  phone          String?          @unique
  password       String
  is_active      Boolean          @default(true)
  created_at     DateTime         @default(now())
  updated_at     DateTime
  sessions       sessions[]
  user_companies user_companies[]
}

enum LocationType {
  BRANCH
  WAREHOUSE
  FACTORY
  STORE
}

enum Role {
  OWNER
  ADMIN
  MANAGER
  EMPLOYEE
}
